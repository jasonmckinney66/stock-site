{% extends "_layout" %}
{% block bodyClass %}home-page{% endblock %}
{% import '_macros.html' as m %}
{% block content %}

{% set blocks = entry.hero.all() %}
{% if blocks|length %}
  <section class="position-relative header-lg zindex-1 overflow-hidden mb-5">
  {% for block in blocks %}

    {% set image = block.backgroundImage.one ?? null %}
    {% if image is not null %}
      <picture class="position-absolute w-100 h-100 zindex-under">
        <!-- mobile -->
        {% if craft.app.images.supportsWebP %}
          <source media="(orientation: portrait) and (max-width: 551px)" srcset="{{ image.getUrl('backgroundMobileWebp') }}" type="image/webp">
        {% endif %}
        <source media="(orientation: portrait) and (max-width: 551px)" srcset="{{ image.getUrl('backgroundMobileJpg') }}" type="image/jpeg">
        <!-- desktop -->
        {% if craft.app.images.supportsWebP %}
          <source srcset="{{ image.getUrl('backgroundDesktopWebp') }}" type="image/webp">
        {% endif %}
        <img class="object-cover" width="100%" height="100%" src="{{ image.getUrl('backgroundDesktopJpg') }}" alt="">
      </picture>
    {% endif %}

    <div class="text-white d-flex align-items-center header-lg{% if image is not null %} gradient-mask{% endif %}">
      <div class="container">
        <h1 class="text-center">{{ block.customHeaderText }}</h1>
        <p class="text-center">{{ block.subtitleText }}</p>
      </div>
    </div>

  {% endfor %}
  </section>
{% endif %}

<section>
  <div class="container">
    <div class="row">
      <div class="col">
        <h3 class="text-center">{{ entry.carouselHeader }}</h3>
      </div>
    </div>
  </div>

  <div id="carouselExampleDark" class="carousel carousel-dark slide" data-bs-ride="carousel">

    <div class="carousel-indicators">
      {% set count = entry.logos.count() %}
      {% set logoCount = count//3 %}
      {% for i in range(1, logoCount) %}
        <button type="button" data-bs-target="#carouselExampleDark" data-bs-slide-to="{{ loop.index0 }}" {% if loop.first %}class="active" aria-current="true"{% endif %} aria-label="Slide {{ loop.index }}"></button>
      {% endfor %}
    </div>

    <div class="carousel-inner">
      {% set logos = entry.logos.all() %}
      {% for logo in logos %}
        {% if loop.index in ['5', '9', '15'] or loop.first %}
          <div class="carousel-item{% if loop.first %} active data-bs-interval='10000'{% endif %}">
            <div class="container">
              <div class="row row-cols-2 row-cols-md-4 justify-content-center p-4">
        {% endif %}
                <div class="col">
                  <img src="{{ logo.getUrl() }}" class="d-block" alt="{{ logo.title }}">
                </div>
        {% if loop.index in ['4', '8'] or loop.last  %}
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
    
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleDark" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
</section>

{% include "_contentBlocks" %}

{% endblock %}